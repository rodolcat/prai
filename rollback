local rollbackButton = script.Parent.RollbackButton  -- Rollback 버튼
local rejoinButton = script.Parent.RejoinButton      -- Rejoin 버튼

-- 로컬 저장소에서 저장된 인벤토리 상태를 저장할 변수
local savedInventoryState = {}

-- Rollback 버튼 클릭 시 인벤토리 상태 저장
rollbackButton.MouseButton1Click:Connect(function()
    local player = game.Players.LocalPlayer
    savedInventoryState = {}  -- 저장할 인벤토리 상태 초기화

    -- 플레이어의 인벤토리 상태 저장
    for _, item in pairs(player.Backpack:GetChildren()) do
        table.insert(savedInventoryState, item.Name)  -- 예시로 아이템 이름만 저장
    end

    -- 인벤토리 상태를 플레이어의 Attribute로 저장
    player:SetAttribute("SavedInventoryState", savedInventoryState)

    print("Rollback 상태 저장 완료!")
end)

-- Rejoin 버튼 클릭 시 저장된 상태로 되돌리기
rejoinButton.MouseButton1Click:Connect(function()
    local player = game.Players.LocalPlayer

    -- 플레이어에서 저장된 상태 불러오기
    local savedState = player:GetAttribute("SavedInventoryState")

    if savedState then
        -- 저장된 인벤토리 상태로 복원
        local backpack = player.Backpack
        -- 기존 아이템 제거 (필요에 따라)
        for _, item in pairs(backpack:GetChildren()) do
            item:Destroy()
        end
        
        -- 저장된 상태로 아이템 복원
        for _, itemName in pairs(savedState) do
            local newItem = Instance.new("Tool")  -- 아이템 복원 (예시)
            newItem.Name = itemName
            newItem.Parent = backpack
        end
        print("Rejoin 완료: 저장된 상태로 돌아갔습니다.")
    else
        print("저장된 상태가 없습니다.")
    end
end)
