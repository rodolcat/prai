local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local player = Players.LocalPlayer

-- 기존 UI 제거
if CoreGui:FindFirstChild("RollbackUI") then
    CoreGui.RollbackUI:Destroy()
end

-- UI 생성
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RollbackUI"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = CoreGui -- 여기! CoreGui에 직접 넣음

-- 버튼 생성 함수
local function createButton(name, text, position, color)
	local btn = Instance.new("TextButton")
	btn.Name = name
	btn.Size = UDim2.new(0, 160, 0, 50)
	btn.Position = position
	btn.Text = text
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 20
	btn.Parent = screenGui
	return btn
end

-- 버튼 생성
local rollbackBtn = createButton("RollbackButton", "Rollback", UDim2.new(0, 100, 0, 200), Color3.fromRGB(255, 100, 100))
local rejoinBtn = createButton("RejoinButton", "Rejoin", UDim2.new(0, 100, 0, 270), Color3.fromRGB(100, 150, 255))

-- 저장용 테이블
local savedInventory = {}

-- Rollback 버튼 기능
rollbackBtn.MouseButton1Click:Connect(function()
	savedInventory = {}
	for _, tool in pairs(player.Backpack:GetChildren()) do
		if tool:IsA("Tool") then
			table.insert(savedInventory, tool.Name)
		end
	end
	print("✅ 저장된 인벤토리:", table.concat(savedInventory, ", "))
end)

-- Rejoin 버튼 기능
rejoinBtn.MouseButton1Click:Connect(function()
	if #savedInventory == 0 then
		warn("❌ 저장된 아이템 없음")
		return
	end

	for _, tool in pairs(player.Backpack:GetChildren()) do
		if tool:IsA("Tool") then
			tool:Destroy()
		end
	end

	for _, itemName in ipairs(savedInventory) do
		local tool = Instance.new("Tool")
		tool.Name = itemName
		tool.Parent = player.Backpack
	end

	print("♻️ 복원 완료:", table.concat(savedInventory, ", "))
end)
