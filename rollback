local Players = game:GetService("Players")
local player = Players.LocalPlayer
local gui = player:WaitForChild("PlayerGui")

-- 혹시 이전에 실행된 UI가 있다면 제거
if gui:FindFirstChild("RollbackUI") then
    gui.RollbackUI:Destroy()
end

-- UI 생성
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RollbackUI"
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.ResetOnSpawn = false
screenGui.Parent = gui

-- 공통 버튼 속성 생성 함수
local function createButton(name, text, position, color)
	local button = Instance.new("TextButton")
	button.Name = name
	button.Size = UDim2.new(0.2, 0, 0.08, 0)
	button.Position = position
	button.Text = text
	button.BackgroundColor3 = color
	button.TextColor3 = Color3.new(1, 1, 1)
	button.Font = Enum.Font.GothamBold
	button.TextSize = 20
	button.Parent = screenGui
	return button
end

-- 버튼 생성
local rollbackButton = createButton("RollbackButton", "Rollback", UDim2.new(0.4, 0, 0.3, 0), Color3.fromRGB(255, 100, 100))
local rejoinButton = createButton("RejoinButton", "Rejoin", UDim2.new(0.4, 0, 0.42, 0), Color3.fromRGB(100, 150, 255))

-- 인벤토리 저장용 테이블
local savedInventory = {}

-- Rollback 저장 기능
rollbackButton.MouseButton1Click:Connect(function()
	savedInventory = {}
	for _, tool in pairs(player.Backpack:GetChildren()) do
		if tool:IsA("Tool") then
			table.insert(savedInventory, tool.Name)
		end
	end
	print("✅ 인벤토리 저장됨:", table.concat(savedInventory, ", "))
end)

-- 복원 기능
rejoinButton.MouseButton1Click:Connect(function()
	if #savedInventory == 0 then
		warn("❌ 저장된 인벤토리 없음")
		return
	end

	for _, tool in pairs(player.Backpack:GetChildren()) do
		if tool:IsA("Tool") then
			tool:Destroy()
		end
	end

	for _, name in ipairs(savedInventory) do
		local tool = Instance.new("Tool")
		tool.Name = name
		tool.Parent = player.Backpack
	end

	print("♻️ 복원 완료:", table.concat(savedInventory, ", "))
end)
